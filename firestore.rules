rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Helper function to check if user is super admin
    function isSuperAdmin() {
      return request.auth != null && request.auth.token.email == 'ap8548328@gmail.com';
    }

    // Admins collection
    match /admins/{adminId} {
      allow read: if true; // Public read
      allow write: if isSuperAdmin(); // Only super admin can write
    }

    // Members collection
    match /members/{userId} {
      allow read: if true; // Public read
      allow write: if request.auth != null && request.auth.uid == userId; // Owner can write
    }

    // Admin Keys collection
    match /admin_keys/{keyId} {
      allow read: if true; // Public read so signup page can verify
      allow write: if isSuperAdmin(); // Only super admin can change the key
    }

    // Roles collection
    match /roles/{roleId} {
      allow read: if true; // Public read to display roles
      allow write: if isSuperAdmin(); // Only super admin can manage roles
    }
  }
}